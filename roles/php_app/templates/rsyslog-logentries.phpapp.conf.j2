$Modload imfile

$InputFileName /var/log/nginx/access.{{ app_name }}.log
$InputFileTag access-{{ app_name }}-log
$InputFileStateFile access-{{ app_name }}-log-file
$InputFileSeverity info
$InputFileFacility local7
$InputRunFileMonitor
$InputFilePollInterval 10

$InputFileName /var/log/nginx/error.{{ app_name }}.log
$InputFileTag error-{{ app_name }}-log
$InputFileStateFile error-{{ app_name }}-log-file
$InputFileSeverity info
$InputFileFacility local7
$InputRunFileMonitor
$InputFilePollInterval 10

$template Logentries,"{{ logentries_token }} %HOSTNAME% %syslogtag%: %msg%\n"
if $programname == 'access-{{ app_name }}-log' then @@data.logentries.com:10000;Logentries
& ~

$template ErrorLogentries,"9fee895d-2b5c-47e4-84e4-2cc28d4775d7 %HOSTNAME% %syslogtag%: %msg%\n"
if $programname == 'error-{{ app_name }}-log' then @@data.logentries.com:10000;ErrorLogentries
& ~
